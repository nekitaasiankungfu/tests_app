# Руководство по маппингу весов вопросов

## Обзор системы

В приложении используется иерархическая система психологических шкал для комплексного анализа личности. Каждый вопрос может влиять на несколько шкал с разными весами.

## Основные правила

### 1. Ограничения весов

- **Максимум шкал на вопрос:** 5
- **Диапазон весов:** 0.3 - 1.0
  - 1.0 - Основное влияние (Primary)
  - 0.8-0.9 - Высокое влияние (High)
  - 0.5-0.7 - Вторичное влияние (Secondary)
  - 0.3-0.4 - Слабое влияние (Minor)
  - < 0.3 - Игнорируется

### 2. Система 8 униполярных шкал личности

Для теста "16 типов личности" используются 8 независимых положительных шкал:

```
Энергия:
- extraversion (Экстраверсия) - ориентация на внешний мир
- introversion (Интроверсия) - ориентация на внутренний мир

Восприятие:
- sensing (Сенсорика) - конкретные факты и детали
- intuition (Интуиция) - паттерны и возможности

Принятие решений:
- thinking (Мышление) - логический анализ
- feeling (Чувство) - ценности и эмпатия

Образ жизни:
- judging (Суждение) - структура и планирование
- perceiving (Восприятие) - гибкость и адаптация
```

### 3. Существующая система иерархических шкал

195 психологических шкал организованы в 18 категорий:

1. **Emotional Stability** (15 подшкал)
2. **Extraversion & Sociability** (11 подшкал)
3. **Agreeableness** (11 подшкал)
4. **Conscientiousness** (12 подшкал)
5. **Openness to Experience** (10 подшкал)
6. **Relationship Quality** (24 подшкалы)
7. **Cognitive Abilities** (12 подшкал)
8. **Motivation & Drive** (11 подшкал)
9. **Social Skills** (15+ подшкал)
10. **Dark Triad**
11. **Leadership**
12. **Values**
13. **Well-being**
14. **Identity**
15. **Stress & Coping**
16. **Creativity**
17. **Behavioral Styles**
18. **Meta-Indicators**

## Инструкция по добавлению новых тестов

### Шаг 1: Анализ вопроса

Определите психологические конструкты, которые измеряет вопрос:

```dart
// Пример: "Я легко завожу новые знакомства"
// Измеряет:
// - Экстраверсию (основное)
// - Социальные навыки (вторичное)
// - Открытость опыту (слабое)
```

### Шаг 2: Назначение весов

```dart
QuestionModel(
  id: 'q1',
  text: {'ru': 'Я легко завожу новые знакомства'},
  axisWeights: {
    'extraversion': 1.0,      // Primary - прямое измерение экстраверсии
    'sociability': 0.8,       // High - социальная компетентность
    'social_confidence': 0.7, // Secondary - уверенность в общении
    'openness': 0.5,         // Secondary - открытость новому опыту
  },
  // Для вопросов теста 16 типов также указываем:
  targetScale: 'extraversion', // Целевая шкала для униполярной системы
)
```

### Шаг 3: Описание логики

Каждый вес должен иметь обоснование в поле `note`:

```dart
note: 'E+: социальная инициатива и энергия от взаимодействия +
       Sociability: навыки установления контактов +
       Confidence: отсутствие социальной тревожности +
       Openness: готовность к новым социальным опытам'
```

## Примеры маппинга для разных типов вопросов

### Социальные вопросы

```dart
"Я предпочитаю работать в команде"
axisWeights: {
  'extraversion': 0.9,
  'cooperation': 0.8,
  'teamwork': 1.0,
  'autonomy_need': -0.6, // Отрицательный вес - обратная связь
}
```

### Когнитивные вопросы

```dart
"Я люблю анализировать сложные проблемы"
axisWeights: {
  'thinking': 1.0,
  'analytical_thinking': 1.0,
  'problem_solving': 0.9,
  'intellectual_curiosity': 0.7,
  'need_for_cognition': 0.8,
}
```

### Эмоциональные вопросы

```dart
"Я легко расстраиваюсь из-за мелочей"
axisWeights: {
  'emotional_stability': -1.0, // Обратная связь
  'neuroticism': 1.0,
  'emotional_reactivity': 0.9,
  'stress_tolerance': -0.8,
  'resilience': -0.7,
}
```

### Мотивационные вопросы

```dart
"Я всегда довожу начатое до конца"
axisWeights: {
  'judging': 0.9,
  'conscientiousness': 1.0,
  'self_discipline': 1.0,
  'achievement_striving': 0.8,
  'persistence': 0.9,
}
```

## Специальные случаи

### 1. Реверсивные вопросы

Для вопросов с полем `isReversed: true` веса применяются к противоположным полюсам:

```dart
"Я избегаю больших компаний" (isReversed: true для экстраверсии)
axisWeights: {
  'introversion': 1.0,  // Прямое измерение интроверсии
  'social_anxiety': 0.6, // Возможная социальная тревожность
}
```

### 2. Биполярные конструкты

Для взаимоисключающих характеристик используйте противоположные веса:

```dart
"Я полагаюсь на факты, а не на интуицию"
axisWeights: {
  'sensing': 1.0,
  'intuition': -1.0,  // Отрицательная корреляция
  'thinking': 0.6,    // Склонность к логике
}
```

### 3. Контекстно-зависимые вопросы

Учитывайте контекст теста при назначении весов:

```dart
// В тесте отношений: "Я доверяю партнеру"
axisWeights: {
  'secure_attachment': 1.0,  // Основное в контексте отношений
  'trust': 0.9,
  'agreeableness': 0.5,      // Вторичное общее качество
}

// В тесте личности: "Я доверяю людям"
axisWeights: {
  'agreeableness': 1.0,       // Основное для личности
  'trust': 0.9,
  'naivety': 0.3,            // Возможный риск
}
```

## Валидация маппинга

### Чек-лист для проверки:

- [ ] Вопрос влияет максимум на 5 шкал
- [ ] Все веса в диапазоне 0.3-1.0 (или отрицательные для обратной связи)
- [ ] Есть хотя бы одна шкала с весом ≥ 0.8 (основное измерение)
- [ ] Логика маппинга описана в поле `note`
- [ ] Для теста 16 типов указано поле `targetScale`
- [ ] Учтены культурные особенности (если применимо)
- [ ] Проверена консистентность с похожими вопросами

## Интеграция с существующей системой

### Файлы для обновления при добавлении нового теста:

1. **Создать файл с весами:**
   ```
   /lib/config/summary/question_weights/[test_name]_weights.dart
   ```

2. **Добавить импорт в summary_config.dart:**
   ```dart
   export 'summary/question_weights/[test_name]_weights.dart';
   ```

3. **Обновить TestService для использования весов:**
   ```dart
   // В методе completeTest()
   if (TestWeights.hasWeights(testId)) {
     // Использовать веса для расчета
   }
   ```

## Примеры готовых маппингов

См. существующие файлы:
- `ipip_big_five_weights.dart` - 50 вопросов Big Five
- `fisher_temperament_weights.dart` - 56 вопросов темперамента
- `simple_tests_weights.dart` - простые тесты (стресс, самооценка)

## Важные замечания

1. **Консистентность:** Похожие вопросы должны иметь похожие веса
2. **Валидность:** Веса должны соответствовать психологической теории
3. **Культурная адаптация:** Учитывайте культурные различия в интерпретации
4. **Тестирование:** Проверяйте результаты на реальных данных
5. **Документация:** Всегда документируйте логику в поле `note`

## Контакты для вопросов

При возникновении вопросов по маппингу обращайтесь к:
- Документации по психометрике
- Существующим примерам в коде
- Научным источникам по валидации тестов